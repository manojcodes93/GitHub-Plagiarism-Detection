{% extends "base.html" %}
{% block content %}

{% if empty %}
<div class="card">
  <h2>No Analysis Data</h2>
  <p style="opacity:.7;">
    Run an analysis to view plagiarism results.
  </p>
</div>
{% else %}

<div class="card">

{# ============================= #}
{# PLAGIARISM CONFIDENCE SUMMARY #}
{# ============================= #}

{% set confidence = "LOW" %}
{% set confidence_color = "#14532d" %}

{% for row in data.similarity_matrix %}
    {% for v in row %}
        {% if v is not none and v|float >= 0.7 %}
            {% set confidence = "HIGH" %}
            {% set confidence_color = "#7f1d1d" %}
        {% elif v is not none and v|float >= 0.4 and confidence != "HIGH" %}
            {% set confidence = "MEDIUM" %}
            {% set confidence_color = "#713f12" %}
        {% endif %}
    {% endfor %}
{% endfor %}

{% if data.suspicious_commits and data.suspicious_commits|length > 0 and confidence == "LOW" %}
    {% set confidence = "MEDIUM" %}
    {% set confidence_color = "#713f12" %}
{% endif %}

<div style="
    background:{{ confidence_color }};
    padding:18px 22px;
    border-radius:12px;
    margin-bottom:28px;
">
    <div style="font-size:20px; font-weight:700;">
        Plagiarism Confidence: {{ confidence }}
    </div>

</div>

<hr>

<h3>Comparisons</h3>

<button class="primary-btn compare-btn"
onclick="location.href='{{ url_for('main.commit_diff_page') }}'">
Commit Message Similarity
</button>

<br>

<button class="primary-btn compare-btn"
onclick="location.href='{{ url_for('main.repo_matrix_page') }}'">
Repository Similarity Matrix
</button>

<br>

<button class="primary-btn compare-btn"
onclick="location.href='{{ url_for('main.compare_view') }}'">
View Side-by-Side Code
</button>


<div id="sideBySideComingSoon"
     style="
        display:none;
        margin-top:14px;
        padding:14px 16px;
        border-radius:10px;
        background:#020617;
        border:1px solid #334155;
        color:#e5e7eb;
        font-size:14px;
     ">
    <strong>Side‑by‑Side Code Comparison</strong><br>
    This feature is under development and will be available in a future update.
</div>

<hr>

<h3>Downloads</h3>

<div class="download-wrap">
  <button class="download-btn"
    onclick="location.href='{{ url_for('main.download_report', type='csv') }}'">
    Download CSV
  </button>

  <button class="download-btn"
    onclick="location.href='{{ url_for('main.download_report', type='pdf') }}'">
    Download PDF
  </button>
</div>

</div>

{% endif %}
{% endblock %}
